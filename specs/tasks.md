# AutoVideoSlice 任务分解

> 按优先级和依赖关系组织的开发任务清单

---

## 📊 优先级说明

| 优先级 | 标识 | 说明                     |
| ------ | ---- | ------------------------ |
| P0     | 🔴   | 阻塞性任务，必须最先完成 |
| P1     | 🟠   | 核心功能，高优先级       |
| P2     | 🟡   | 重要功能，中优先级       |
| P3     | 🟢   | 增强功能，可延后         |

---

## Phase 1：基础框架搭建

### 1.1 环境初始化

| ID    | 任务                          | 优先级 | 依赖  | 状态 |
| ----- | ----------------------------- | ------ | ----- | ---- |
| 1.1.1 | 创建项目目录结构              | 🔴 P0  | -     | [x]  |
| 1.1.2 | 初始化 Python 虚拟环境 (uv)   | 🔴 P0  | 1.1.1 | [x]  |
| 1.1.3 | 创建 `pyproject.toml`         | 🔴 P0  | 1.1.2 | [x]  |
| 1.1.4 | 初始化前端项目 (Vite + React) | 🔴 P0  | 1.1.1 | [x]  |

### 1.2 后端基础

| ID    | 任务                            | 优先级 | 依赖  | 状态 |
| ----- | ------------------------------- | ------ | ----- | ---- |
| 1.2.1 | 创建 FastAPI 入口文件 `main.py` | 🔴 P0  | 1.1.3 | [x]  |
| 1.2.2 | 配置 CORS 中间件                | 🟠 P1  | 1.2.1 | [x]  |
| 1.2.3 | 创建健康检查接口 `/health`      | 🟠 P1  | 1.2.1 | [x]  |
| 1.2.4 | 创建配置管理模块 `config.py`    | 🟠 P1  | 1.2.1 | [x]  |

### 1.3 字幕解析模块

| ID    | 任务                                   | 优先级 | 依赖  | 状态 |
| ----- | -------------------------------------- | ------ | ----- | ---- |
| 1.3.1 | 创建字幕数据模型                       | 🟠 P1  | 1.2.1 | [x]  |
| 1.3.2 | 实现 SRT 解析器                        | 🟠 P1  | 1.3.1 | [x]  |
| 1.3.3 | 实现 VTT 解析器                        | 🟡 P2  | 1.3.1 | [x]  |
| 1.3.4 | 创建字幕解析 API `/api/subtitle/parse` | 🟠 P1  | 1.3.2 | [x]  |

### 1.4 前端基础

| ID    | 任务                          | 优先级 | 依赖  | 状态 |
| ----- | ----------------------------- | ------ | ----- | ---- |
| 1.4.1 | 创建 Apple 风格设计系统 (CSS) | 🟠 P1  | 1.1.4 | [x]  |
| 1.4.2 | 创建布局组件 `Layout.jsx`     | 🟠 P1  | 1.4.1 | [x]  |
| 1.4.3 | 创建文件上传组件              | 🟠 P1  | 1.4.2 | [x]  |
| 1.4.4 | 集成后端 API 服务层           | 🟠 P1  | 1.2.3 | [x]  |

---

## Phase 2：AI 分析集成

### 2.1 AI 服务抽象层

| ID    | 任务                          | 优先级 | 依赖         | 状态 |
| ----- | ----------------------------- | ------ | ------------ | ---- |
| 2.1.1 | 创建 AI 服务基类 `base_ai.py` | 🔴 P0  | 1.2.1        | [x]  |
| 2.1.2 | 实现豆包 API 客户端           | 🟠 P1  | 2.1.1        | [x]  |
| 2.1.3 | 实现 Ollama 客户端 (qwen3:4b) | 🟠 P1  | 2.1.1        | [x]  |
| 2.1.4 | 实现模型自动切换逻辑          | 🟡 P2  | 2.1.2, 2.1.3 | [x]  |

### 2.2 内容分析功能

| ID    | 任务                        | 优先级 | 依赖         | 状态 |
| ----- | --------------------------- | ------ | ------------ | ---- |
| 2.2.1 | 设计高光提取 Prompt         | 🟠 P1  | 2.1.1        | [x]  |
| 2.2.2 | 实现高光片段提取逻辑        | 🟠 P1  | 2.2.1, 1.3.4 | [x]  |
| 2.2.3 | 创建分析结果数据模型        | 🟠 P1  | 2.2.2        | [x]  |
| 2.2.4 | 创建分析 API `/api/analyze` | 🟠 P1  | 2.2.3        | [x]  |

### 2.3 标题生成功能

| ID    | 任务                                | 优先级 | 依赖  | 状态 |
| ----- | ----------------------------------- | ------ | ----- | ---- |
| 2.3.1 | 设计标题生成 Prompt                 | 🟠 P1  | 2.1.1 | [x]  |
| 2.3.2 | 实现标题生成逻辑                    | 🟠 P1  | 2.3.1 | [x]  |
| 2.3.3 | 创建标题 API `/api/titles/generate` | 🟠 P1  | 2.3.2 | [x]  |

### 2.4 评分系统

| ID    | 任务               | 优先级 | 依赖  | 状态 |
| ----- | ------------------ | ------ | ----- | ---- |
| 2.4.1 | 定义评分维度和算法 | 🟡 P2  | 2.2.3 | [x]  |
| 2.4.2 | 实现片段评分逻辑   | 🟡 P2  | 2.4.1 | [x]  |
| 2.4.3 | 评分结果展示 UI    | 🟡 P2  | 2.4.2 | [x]  |

---

## Phase 3：视频处理

### 3.1 FFmpeg 集成

| ID    | 任务                 | 优先级 | 依赖  | 状态 |
| ----- | -------------------- | ------ | ----- | ---- |
| 3.1.1 | 创建 FFmpeg 工具模块 | 🔴 P0  | 1.2.1 | [x]  |
| 3.1.2 | 实现视频信息读取功能 | 🟠 P1  | 3.1.1 | [x]  |
| 3.1.3 | 实现视频时间段切割   | 🟠 P1  | 3.1.1 | [x]  |
| 3.1.4 | 实现缩略图生成       | 🟡 P2  | 3.1.1 | [x]  |

### 3.2 视频切割功能

| ID    | 任务                              | 优先级 | 依赖  | 状态 |
| ----- | --------------------------------- | ------ | ----- | ---- |
| 3.2.1 | 创建切割任务队列                  | 🟠 P1  | 3.1.3 | [x]  |
| 3.2.2 | 实现批量切割接口 `/api/video/cut` | 🟠 P1  | 3.2.1 | [x]  |
| 3.2.3 | 创建切割进度展示 UI               | 🟠 P1  | 3.2.2 | [x]  |

### 3.3 导出功能

| ID    | 任务                  | 优先级 | 依赖  | 状态 |
| ----- | --------------------- | ------ | ----- | ---- |
| 3.3.1 | 实现单视频导出        | 🟠 P1  | 3.2.2 | [ ]  |
| 3.3.2 | 实现分类打包导出      | 🟡 P2  | 3.3.1 | [ ]  |
| 3.3.3 | 实现合集导出          | 🟡 P2  | 3.3.1 | [ ]  |
| 3.3.4 | 导出结果展示和下载 UI | 🟠 P1  | 3.3.1 | [ ]  |

---

## Phase 4：UI 美化与体验优化

### 4.1 UI 完善

| ID    | 任务                 | 优先级 | 依赖    | 状态 |
| ----- | -------------------- | ------ | ------- | ---- |
| 4.1.1 | 完善首页设计         | 🟡 P2  | Phase 3 | [ ]  |
| 4.1.2 | 添加页面过渡动画     | 🟢 P3  | 4.1.1   | [ ]  |
| 4.1.3 | 添加加载状态和骨架屏 | 🟡 P2  | 4.1.1   | [ ]  |
| 4.1.4 | 响应式布局适配       | 🟡 P2  | 4.1.1   | [ ]  |

### 4.2 用户体验

| ID    | 任务                      | 优先级 | 依赖  | 状态 |
| ----- | ------------------------- | ------ | ----- | ---- |
| 4.2.1 | 添加操作反馈 (Toast 通知) | 🟡 P2  | 4.1.1 | [ ]  |
| 4.2.2 | 添加快捷键支持            | 🟢 P3  | 4.1.1 | [ ]  |
| 4.2.3 | 添加设置页面              | 🟡 P2  | 4.1.1 | [ ]  |
| 4.2.4 | 添加使用引导              | 🟢 P3  | 4.2.3 | [ ]  |

---

## 📈 依赖关系图

```
Phase 1 (基础框架)
    │
    ├── 1.1 环境初始化 ──────┐
    │                        │
    ├── 1.2 后端基础 ◄───────┤
    │       │                │
    ├── 1.3 字幕解析 ◄───────┤
    │                        │
    └── 1.4 前端基础 ◄───────┘
            │
            ▼
Phase 2 (AI 分析)
    │
    ├── 2.1 AI 服务层 ◄── 依赖 1.3
    │       │
    ├── 2.2 内容分析 ◄───────┤
    │       │                │
    ├── 2.3 标题生成 ◄───────┤
    │                        │
    └── 2.4 评分系统 ◄───────┘
            │
            ▼
Phase 3 (视频处理)
    │
    ├── 3.1 FFmpeg ◄── 依赖 2.2
    │       │
    ├── 3.2 视频切割 ◄───────┤
    │                        │
    └── 3.3 导出功能 ◄───────┘
            │
            ▼
Phase 4 (UI 美化)
```

---

_最后更新: 2025-12-15_
